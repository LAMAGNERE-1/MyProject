<!-- 
	L'objectif est d'écrire un algorithme génétique.
	Il s'agit de reproduire le comportement d'un banc
	de poissons qui nagent dans des directions aléatoires
	dans un aquarium.
	
	L'animation devra être produite dans une balise canvas.
	Les poissons devront faire l'objet d'une représentation
	visuelle (par forcément réaliste !).
	
	Le programme doit respecter les règles suivantes :
	- Un aquarium contient un nombre aléatoire de poissons (un aquarium
	  est un tableau d'objet de type poisson);
	- Chaque poisson se déplace dans une direction aléatoire (les 
	  poisson on un "vecteur de déplacement" aléatoire);
	- Si un poisson est à une certaine distance d'un autre poisson
	  il doit se mettre à se déplacer dans la même direction (un poisson
	  a un "champ de vision");
	- Si un poisson atteint les limites de l'aquarium, il doit changer
	  de direction pour une nouvelle direction aléatoire (un poisson
	  ne peut pas sortir de l'aquarium);
	- Le pointeur de la souris de l'utilisateur peut survoler l'aquarium.
	  Si le pointeur de la souris se situe à une certaine distance d'un
	  poisson, celui-ci doit changer de direction pour une direction al�atoire
	  opposée à la position du pointeur de la souris (un poisson "a peur" de
	  la souris). -->
      <!DOCTYPE html>
      <html lang="en">
      <head>
          <meta charset="UTF-8">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <title>Les poissons</title>
      </head>
      <body>
          <p id="aquarium">Dessiner un aquarium</p>
                <canvas width="1000px" height="500px" id="mycanvas"></canvas>
          <script>
      
          // (function() {
      
          var myCanvas = document.getElementById('mycanvas');

          var ctx = myCanvas.getContext('2d');  

          function creerBocal() {
            const bocal = myCanvas.getContext('2d');  
            bocal.lineWidth = "7px";
            bocal.strokeStyle = "red";
            bocal.beginPath();
            bocal.moveTo(10, 50);
            bocal.lineTo(10, 440);
            bocal.lineTo(980, 440); 
            bocal.lineTo(980,50);
            bocal.stroke();
            bocal.closePath();
          }

          function creerEau() {
            const eau = myCanvas.getContext('2d');
            eau.strokeStyle = "blue";
            eau.beginPath();
            eau.moveTo(10,70);
            eau.lineTo(980,70);
            eau.stroke();
            eau.closePath();
          }  

          function ConstructeurPoissons(coordX,coordY,color) {
                  this._poisson = myCanvas.getContext('2d');
                  this.color = color;
                  this._poisson.strokeStyle = color;
                //   this.coordX = coordX;
                //   this.coordY = coordY; 
                  this._poisson.strokeRect(coordX, coordY, 15, 30);
          }
          ConstructeurPoissons.prototype = {
          constructor: ConstructeurPoissons,
          allerADroite: function() {
            var horizontal = 1;
          },
          allerAGauche: function() {
            var horizontal = -1;
          },
          allerEnBas: function() {
            var vertical = 1;
          },
          allerEnHaut: function() {
            var vertical = -1;
          }
          };
      
          var poisson = [];
          var coordX;
          var coordY;   
          function creerPoissons() {
              for (var i = 0; i<20;i++) {
                var color = "blue";
                coordX = 10 + 955*Math.random();
                coordY = 120 + 270*Math.random();    
                poisson[i] = new ProtoPoissons(coordX,coordY,color);
              }
          }



          var a = 0;
          var b = 0;
          document.getElementById('aquarium').addEventListener('click',creerAquarium);
      
          function creerAquarium() {
            document.getElementById('aquarium').removeEventListener('click',creerAquarium);  
            
            // var a ;
            if (a == 0) {
            creerBocal();
            creerEau();
            creerPoissons();
            a = 1;
            // console.log(poisson[0].coordX);
            } else {
            ctx.clearRect(0,0,1000,500);
            creerBocal();
            creerEau();
            // var b;
            if (b !=-1 && b!=1) {
                b=1
            }
            console.log(poisson[0].coordY);
// console.log(b);
for (var j = 0; j < 20; j++){
    
    
    if (b == -1) {
        coordX = poisson[j].coordX - 1*j*Math.random();
        coordY = poisson[j].coordY - 1*Math.random();
    } else {
        coordX = poisson[j].coordX + 1*j*Math.random();
        coordY = poisson[j].coordY + 1*Math.random();
    }
    
    if (((poisson[j].coordX + 15 >= 979) ||  (poisson[j].coordY + 30 >= 439)) && b == 1) {
        b = -1;
    // } else if (((poisson[j].coordX + 15 < 980) &&  (poisson[j].coordY + 30 < 440)) && b == 1) {
    //     b = 1;
    } else if ((( poisson[j].coordX - 1 <= 10) || (poisson[j].coordY - 1 <= 70)) && b == -1) {
        b = 1;
    // } else if ((( poisson[j].coordX - 1 > 10) && (poisson[j].coordY - 1 > 70)) && b == -1) {
    //     b = -1;
    }
    console.log(b);
color = "blue";
poisson[j] = new ProtoPoissons(coordX,coordY,color);
  }
            //   console.log(poisson[0].coordX); 
            }    
            requestAnimationFrame(creerAquarium);

            
          } // pour function creerAquarium
          // })(); // pour la fonction IFFE
      
      
         


          </script>
      </body>
      </html>